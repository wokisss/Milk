{"version":3,"file":"my.js","sources":["pages/my/my.vue","../../../../Hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvbXkudnVl"],"sourcesContent":["<template>\n  <view class=\"my-page\">\n    <!-- 个人信息卡片：仅保留头像+登录后信息，靠左对齐 -->\n    <view class=\"user-card\">\n      <view class=\"avatar-container\">\n        <image \n          src=\"https://via.placeholder.com/100x100?text=头像\" \n          class=\"avatar\" \n          mode=\"aspectFit\"\n        />\n      </view>\n      <!-- 姓名和手机号靠左对齐，无额外文字 -->\n      <view class=\"user-info\">\n        <view class=\"user-name\">{{ userInfo.name || '未登录' }}</view>\n        <view class=\"user-phone\" v-if=\"userInfo.phone\">{{ userInfo.phone }}</view>\n      </view>\n    </view>\n\n    <!-- 表单区域（含性别选择，适配微信小程序） -->\n    <view class=\"form-container\">\n      <view class=\"form-title\">个人资料编辑</view>\n\n      <!-- 姓名输入 -->\n      <view class=\"form-item\">\n        <view class=\"label\">姓名</view>\n        <input \n          class=\"input\" \n          type=\"text\" \n          v-model=\"form.name\" \n          placeholder=\"请输入姓名\"\n        />\n      </view>\n\n      <!-- 性别选择（微信小程序兼容写法） -->\n      <view class=\"form-item gender-item\">\n        <view class=\"label\">性别</view>\n        <radio-group class=\"gender-options\" @change=\"handleGenderChange\">\n          <label class=\"radio-label\">\n            <radio value=\"male\" :checked=\"form.gender === 'male'\" color=\"#1980FF\" /> 男\n          </label>\n          <label class=\"radio-label\">\n            <radio value=\"female\" :checked=\"form.gender === 'female'\" color=\"#1980FF\" /> 女\n          </label>\n        </radio-group>\n      </view>\n\n      <!-- 手机号输入 -->\n      <view class=\"form-item\">\n        <view class=\"label\">手机号</view>\n        <input \n          class=\"input\" \n          type=\"number\" \n          v-model=\"form.phone\" \n          placeholder=\"请输入手机号\"\n          maxlength=\"11\"\n        />\n      </view>\n\n      <!-- 保存按钮 -->\n      <view class=\"save-btn\" @click=\"handleSave\">\n        保存信息\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch } from 'vue';\n\n// 登录用户信息（纯本地存储，与登录页同步字段）\nconst userInfo = ref({\n  name: '',\n  gender: '', // 存储文本：'男'/'女'/'未选择'\n  phone: ''\n});\n\n// 表单数据（用于编辑，与存储字段映射）\nconst form = ref({\n  name: '',\n  gender: '', // 存储值：'male'/'female'/'': 与radio值对应\n  phone: ''\n});\n\n// 页面加载时，从本地存储读取信息（关键：与登录页存储的key和字段一致）\nonMounted(() => {\n  // 读取登录时存储的用户信息（登录页需用同样的key：'userInfo'）\n  const storedUser = uni.getStorageSync('userInfo');\n  if (storedUser && storedUser.phone) { // 有手机号视为已登录\n    userInfo.value = {\n      name: storedUser.name || '',\n      gender: storedUser.gender || '未选择',\n      phone: storedUser.phone || ''\n    };\n\n    // 初始化表单：将存储的文本（'男'/'女'）映射为radio的value（'male'/'female'）\n    form.value = {\n      name: storedUser.name || '',\n      gender: storedUser.gender === '男' ? 'male' : storedUser.gender === '女' ? 'female' : '',\n      phone: storedUser.phone || ''\n    };\n  } else {\n    // 未登录：跳转登录页（可选，根据需求是否强制登录）\n    uni.navigateTo({ url: '/pages/login/login' });\n  }\n});\n\n// 监听性别选择变化（微信小程序兼容）\nconst handleGenderChange = (e) => {\n  form.value.gender = e.detail.value;\n};\n\n// 保存个人信息（更新本地存储，覆盖旧数据）\nconst handleSave = () => {\n  // 表单校验\n  if (!form.value.name.trim()) {\n    uni.showToast({ title: '请输入姓名', icon: 'none', duration: 1500 });\n    return;\n  }\n  if (!form.value.phone || form.value.phone.length !== 11) {\n    uni.showToast({ title: '请输入正确的手机号', icon: 'none', duration: 1500 });\n    return;\n  }\n\n  // 转换性别：表单value（'male'/'female'）→ 存储文本（'男'/'女'）\n  const genderText = form.value.gender === 'male' ? '男' : form.value.gender === 'female' ? '女' : '未选择';\n\n  // 更新用户信息（最新修改的内容）\n  const updatedUser = {\n    name: form.value.name.trim(),\n    gender: genderText,\n    phone: form.value.phone\n  };\n\n  // 同步到本地存储（覆盖登录时的旧数据）\n  userInfo.value = updatedUser;\n  uni.setStorageSync('userInfo', updatedUser);\n\n  // 提示保存成功\n  uni.showToast({ title: '信息保存成功', icon: 'success', duration: 1500 });\n};\n</script>\n\n<style scoped>\n/* 页面整体样式：禁用滑动，固定高度 */\n.my-page {\n  background-color: #f5f5f5;\n  height: 100vh; /* 固定页面高度，不滚动 */\n  overflow: hidden; /* 禁用滚动（替代小程序不支持的 DOM 操作） */\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  padding-bottom: 30rpx; /* 底部预留空间 */\n}\n\n/* 个人信息卡片：靠左对齐，移除居中 */\n.user-card {\n  background-color: #fff;\n  padding: 40rpx 30rpx;\n  display: flex;\n  align-items: center;\n  margin: 0;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.avatar-container {\n  width: 160rpx;\n  height: 160rpx;\n  border-radius: 50%;\n  overflow: hidden;\n  margin-right: 30rpx;\n  background-color: #eee;\n  border: 4rpx solid #f0f0f0; /* 优化头像边框 */\n}\n\n.avatar {\n  width: 100%;\n  height: 100%;\n}\n\n/* 登录后信息：靠左对齐，简洁样式 */\n.user-info {\n  text-align: left;\n}\n\n.user-name {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n.user-phone {\n  font-size: 26rpx;\n  color: #666;\n}\n\n/* 表单容器：紧凑布局，避免滚动 */\n.form-container {\n  background-color: #fff;\n  padding: 0 30rpx 30rpx;\n  margin: 20rpx;\n  border-radius: 16rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n}\n\n.form-title {\n  font-size: 28rpx;\n  font-weight: 600;\n  color: #333;\n  padding: 24rpx 0;\n  border-bottom: 1rpx solid #eee;\n  margin-bottom: 24rpx;\n}\n\n/* 表单项样式 */\n.form-item {\n  display: flex;\n  align-items: center;\n  padding: 24rpx 0;\n  border-bottom: 1rpx solid #eee;\n}\n\n.form-item:last-child {\n  border-bottom: none;\n}\n\n.label {\n  width: 120rpx;\n  font-size: 26rpx;\n  color: #333;\n}\n\n.input {\n  flex: 1;\n  font-size: 26rpx;\n  color: #333;\n  padding: 8rpx 0;\n}\n\n/* 性别选择样式 */\n.gender-item {\n  align-items: center;\n}\n\n.gender-options {\n  flex: 1;\n  display: flex;\n  gap: 60rpx;\n  align-items: center;\n}\n\n.radio-label {\n  display: flex;\n  align-items: center;\n  font-size: 26rpx;\n  color: #333;\n  cursor: pointer;\n}\n\n.radio-label radio {\n  margin-right: 12rpx;\n}\n\n/* 保存按钮：优化位置，避免底部溢出 */\n.save-btn {\n  margin-top: 30rpx;\n  height: 90rpx;\n  background-color: #1980FF;\n  color: #fff;\n  border-radius: 45rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 32rpx;\n  font-weight: 500;\n}\n</style>","import MiniProgramPage from 'D:/桌面/研一/软件工程/product-traceability/pages/my/my.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","uni"],"mappings":";;;;;AAsEA,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,MAAM;AAAA,MACN,QAAQ;AAAA;AAAA,MACR,OAAO;AAAA,IACT,CAAC;AAGD,UAAM,OAAOA,cAAAA,IAAI;AAAA,MACf,MAAM;AAAA,MACN,QAAQ;AAAA;AAAA,MACR,OAAO;AAAA,IACT,CAAC;AAGDC,kBAAAA,UAAU,MAAM;AAEd,YAAM,aAAaC,cAAAA,MAAI,eAAe,UAAU;AAChD,UAAI,cAAc,WAAW,OAAO;AAClC,iBAAS,QAAQ;AAAA,UACf,MAAM,WAAW,QAAQ;AAAA,UACzB,QAAQ,WAAW,UAAU;AAAA,UAC7B,OAAO,WAAW,SAAS;AAAA,QACjC;AAGI,aAAK,QAAQ;AAAA,UACX,MAAM,WAAW,QAAQ;AAAA,UACzB,QAAQ,WAAW,WAAW,MAAM,SAAS,WAAW,WAAW,MAAM,WAAW;AAAA,UACpF,OAAO,WAAW,SAAS;AAAA,QACjC;AAAA,MACA,OAAS;AAELA,sBAAAA,MAAI,WAAW,EAAE,KAAK,qBAAsB,CAAA;AAAA,MAC7C;AAAA,IACH,CAAC;AAGD,UAAM,qBAAqB,CAAC,MAAM;AAChC,WAAK,MAAM,SAAS,EAAE,OAAO;AAAA,IAC/B;AAGA,UAAM,aAAa,MAAM;AAEvB,UAAI,CAAC,KAAK,MAAM,KAAK,KAAI,GAAI;AAC3BA,4BAAI,UAAU,EAAE,OAAO,SAAS,MAAM,QAAQ,UAAU,KAAI,CAAE;AAC9D;AAAA,MACD;AACD,UAAI,CAAC,KAAK,MAAM,SAAS,KAAK,MAAM,MAAM,WAAW,IAAI;AACvDA,4BAAI,UAAU,EAAE,OAAO,aAAa,MAAM,QAAQ,UAAU,KAAI,CAAE;AAClE;AAAA,MACD;AAGD,YAAM,aAAa,KAAK,MAAM,WAAW,SAAS,MAAM,KAAK,MAAM,WAAW,WAAW,MAAM;AAG/F,YAAM,cAAc;AAAA,QAClB,MAAM,KAAK,MAAM,KAAK,KAAM;AAAA,QAC5B,QAAQ;AAAA,QACR,OAAO,KAAK,MAAM;AAAA,MACtB;AAGE,eAAS,QAAQ;AACjBA,oBAAAA,MAAI,eAAe,YAAY,WAAW;AAG1CA,0BAAI,UAAU,EAAE,OAAO,UAAU,MAAM,WAAW,UAAU,KAAI,CAAE;AAAA,IACpE;;;;;;;;;;;;;;;;;;;;;AC1IA,GAAG,WAAW,eAAe;"}