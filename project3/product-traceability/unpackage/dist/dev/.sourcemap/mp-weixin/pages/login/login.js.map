{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../../../Hbuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\n  <view class=\"login-page\">\n    <!-- 顶部导航栏 -->\n    <view class=\"nav-bar\">\n      <view class=\"title\">牛奶溯源</view>\n    </view>\n\n    <!-- 卡通图标区域 -->\n    <view class=\"icon-container\">\n      <view class=\"icon-bg\">\n        <image src=\"/static/cartoon-icon.png\" class=\"cartoon-icon\" mode=\"widthFix\" />\n      </view>\n    </view>\n\n    <!-- 表单区域 -->\n    <view class=\"form-container\">\n      <!-- 名称输入 -->\n      <view class=\"form-item\">\n        <view class=\"label\">名称</view>\n        <input \n          class=\"input\" \n          type=\"text\" \n          placeholder=\"请输入名称\" \n          v-model=\"formData.name\"\n        />\n      </view>\n\n      <!-- 性别选择：点击文字/圈圈都能取消选中 -->\n      <view class=\"form-item\">\n        <view class=\"label\">性别</view>\n        <view class=\"radio-group\">\n          <!-- 男选项：点击文字/圈圈触发 -->\n          <label class=\"radio-label\" @click=\"handleGender('male')\">\n            <radio \n              value=\"male\" \n              color=\"#1980FF\"\n              :checked=\"formData.gender === 'male'\"\n              @click.stop=\"handleGender('male')\"\n            />\n            <text>男</text>\n          </label>\n          <!-- 女选项：点击文字/圈圈触发 -->\n          <label class=\"radio-label\" @click=\"handleGender('female')\">\n            <radio \n              value=\"female\" \n              color=\"#1980FF\"\n              :checked=\"formData.gender === 'female'\"\n              @click.stop=\"handleGender('female')\"\n            />\n            <text>女</text>\n          </label>\n        </view>\n      </view>\n\n      <!-- 手机号输入 -->\n      <view class=\"form-item\">\n        <view class=\"label\">手机号</view>\n        <input \n          class=\"input\" \n          type=\"number\" \n          placeholder=\"请输入手机号\" \n          v-model=\"formData.phone\"\n          maxlength=\"11\"\n        />\n      </view>\n    </view>\n\n    <!-- 错误提示 -->\n    <view class=\"error-tip\" v-if=\"errorMsg\">{{ errorMsg }}</view>\n\n    <!-- 登录按钮 -->\n    <view class=\"login-btn\" @click=\"handleLogin\">\n      登录\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'; // 新增 onMounted 导入\n\n// 表单数据\nconst formData = ref({\n  name: '',\n  gender: '', // 空=未选择，'male'=男，'female'=女\n  phone: ''\n});\n\n// 错误提示信息\nconst errorMsg = ref('');\n\n// 新增：页面加载时，自动填充历史登录/修改过的信息\nonMounted(() => {\n  // 读取本地存储的用户信息（和 my.vue 共用同一个 key：'userInfo'）\n  const storedUser = uni.getStorageSync('userInfo');\n  if (storedUser && storedUser.phone) { // 有手机号视为有历史信息\n    // 自动填充到表单：姓名、手机号直接填，性别转换为 'male'/'female' 适配单选框\n    formData.value = {\n      name: storedUser.name || '',\n      gender: storedUser.gender === '男' ? 'male' : storedUser.gender === '女' ? 'female' : '',\n      phone: storedUser.phone || ''\n    };\n  }\n});\n\n// 处理性别选择/取消（点击文字/圈圈都触发）\nconst handleGender = (targetGender) => {\n  // 已选中则取消，未选中则切换\n  formData.value.gender = formData.value.gender === targetGender ? '' : targetGender;\n  // 取消选中后清空错误提示（可选，优化体验）\n  if (formData.value.gender) errorMsg.value = '';\n};\n\n// 登录处理函数（无需修改，已和 my.vue 统一存储格式）\nconst handleLogin = () => {\n  errorMsg.value = '';\n\n  // 表单校验\n  if (!formData.value.name.trim()) {\n    errorMsg.value = '请输入名称';\n    return;\n  }\n  if (!formData.value.gender) {\n    errorMsg.value = '请选择性别';\n    return;\n  }\n  if (!formData.value.phone || formData.value.phone.length !== 11) {\n    errorMsg.value = '请输入正确的手机号';\n    return;\n  }\n\n  // 模拟登录：存储格式与 my.vue 完全同步\n  uni.showLoading({ title: '正在登录...' });\n  setTimeout(() => {\n    uni.hideLoading();\n    uni.showToast({ title: '登录成功', icon: 'success' });\n    uni.setStorageSync('userInfo', {\n      name: formData.value.name,\n      gender: formData.value.gender === 'male' ? '男' : '女',\n      phone: formData.value.phone\n    });\n    setTimeout(() => {\n      uni.switchTab({ url: '/pages/home/home' });\n    }, 1000);\n  }, 800);\n};\n</script>\n\n<style scoped>\n/* 页面整体样式 */\n.login-page {\n  width: 100%;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n}\n\n/* 顶部导航栏 */\n.nav-bar {\n  height: 88rpx;\n  background-color: #1980FF;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.title {\n  color: #fff;\n  font-size: 36rpx;\n  font-weight: bold;\n}\n\n/* 卡通图标区域 */\n.icon-container {\n  display: flex;\n  justify-content: center;\n  padding: 60rpx 0;\n}\n\n.icon-bg {\n  width: 200rpx;\n  height: 200rpx;\n  border-radius: 50%;\n  background-color: #ffebee;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.cartoon-icon {\n  width: 120rpx;\n  height: 120rpx;\n}\n\n/* 表单容器 */\n.form-container {\n  padding: 0 40rpx;\n}\n\n/* 表单项样式 */\n.form-item {\n  display: flex;\n  align-items: center;\n  padding: 25rpx 0;\n  border-bottom: 1px solid #eee;\n  background-color: #fff;\n}\n\n/* 第一个表单项圆角 */\n.form-item:first-child {\n  border-top-left-radius: 12rpx;\n  border-top-right-radius: 12rpx;\n  padding-top: 30rpx;\n}\n\n/* 最后一个表单项圆角（无下边框） */\n.form-item:last-child {\n  border-bottom-left-radius: 12rpx;\n  border-bottom-right-radius: 12rpx;\n  padding-bottom: 30rpx;\n  border-bottom: none;\n}\n\n/* 表单项标签 */\n.label {\n  width: 140rpx;\n  font-size: 30rpx;\n  color: #333;\n}\n\n/* 输入框样式 */\n.input {\n  flex: 1;\n  font-size: 30rpx;\n  padding: 5rpx 0;\n  color: #333;\n}\n\n/* 性别选择容器（横向排列） */\n.radio-group {\n  flex: 1;\n  display: flex;\n  gap: 40rpx; /* 男女选项间距 */\n}\n\n/* 单选框+文字组合样式（增大点击区域） */\n.radio-label {\n  display: flex;\n  align-items: center;\n  font-size: 30rpx;\n  color: #333;\n  cursor: pointer;\n  padding: 10rpx 0; /* 增大点击区域 */\n}\n\n/* 单选框与文字间距 */\n.radio-label text {\n  margin-left: 10rpx;\n}\n\n/* 错误提示样式 */\n.error-tip {\n  color: #ff4d4f;\n  font-size: 26rpx;\n  padding: 0 40rpx 20rpx;\n}\n\n/* 登录按钮样式 */\n.login-btn {\n  width: calc(100% - 80rpx);\n  height: 90rpx;\n  background-color: #1980FF;\n  color: #fff;\n  font-size: 32rpx;\n  border-radius: 45rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 60rpx auto;\n  font-weight: 500;\n}\n</style>","import MiniProgramPage from 'D:/桌面/研一/软件工程/product-traceability/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","uni"],"mappings":";;;;;;AAiFA,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,MAAM;AAAA,MACN,QAAQ;AAAA;AAAA,MACR,OAAO;AAAA,IACT,CAAC;AAGD,UAAM,WAAWA,cAAAA,IAAI,EAAE;AAGvBC,kBAAAA,UAAU,MAAM;AAEd,YAAM,aAAaC,cAAAA,MAAI,eAAe,UAAU;AAChD,UAAI,cAAc,WAAW,OAAO;AAElC,iBAAS,QAAQ;AAAA,UACf,MAAM,WAAW,QAAQ;AAAA,UACzB,QAAQ,WAAW,WAAW,MAAM,SAAS,WAAW,WAAW,MAAM,WAAW;AAAA,UACpF,OAAO,WAAW,SAAS;AAAA,QACjC;AAAA,MACG;AAAA,IACH,CAAC;AAGD,UAAM,eAAe,CAAC,iBAAiB;AAErC,eAAS,MAAM,SAAS,SAAS,MAAM,WAAW,eAAe,KAAK;AAEtE,UAAI,SAAS,MAAM;AAAQ,iBAAS,QAAQ;AAAA,IAC9C;AAGA,UAAM,cAAc,MAAM;AACxB,eAAS,QAAQ;AAGjB,UAAI,CAAC,SAAS,MAAM,KAAK,KAAI,GAAI;AAC/B,iBAAS,QAAQ;AACjB;AAAA,MACD;AACD,UAAI,CAAC,SAAS,MAAM,QAAQ;AAC1B,iBAAS,QAAQ;AACjB;AAAA,MACD;AACD,UAAI,CAAC,SAAS,MAAM,SAAS,SAAS,MAAM,MAAM,WAAW,IAAI;AAC/D,iBAAS,QAAQ;AACjB;AAAA,MACD;AAGDA,oBAAAA,MAAI,YAAY,EAAE,OAAO,UAAW,CAAA;AACpC,iBAAW,MAAM;AACfA,sBAAG,MAAC,YAAW;AACfA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAS,CAAE;AAChDA,sBAAG,MAAC,eAAe,YAAY;AAAA,UAC7B,MAAM,SAAS,MAAM;AAAA,UACrB,QAAQ,SAAS,MAAM,WAAW,SAAS,MAAM;AAAA,UACjD,OAAO,SAAS,MAAM;AAAA,QAC5B,CAAK;AACD,mBAAW,MAAM;AACfA,wBAAAA,MAAI,UAAU,EAAE,KAAK,mBAAoB,CAAA;AAAA,QAC1C,GAAE,GAAI;AAAA,MACR,GAAE,GAAG;AAAA,IACR;;;;;;;;;;;;;;;;;;;;;;;;AC/IA,GAAG,WAAW,eAAe;"}